!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("browser-monads-ts")):"function"==typeof define&&define.amd?define(["browser-monads-ts"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["browser-monads-ts"])}(this,(function(e){"use strict";const t="--:-- --",n="",r={hrs24:null,hrs12:null,minutes:null,mode:null};const s=function(){if(!e.exists(e.window)||!e.exists(e.document))return!1;const t=e.document.createElement("input");t.setAttribute("type","time");const n="not-a-time";return t.setAttribute("value",n),t.value!==n}();e.exists(e.window)&&(e.window.supportsTime=s);const i={string12hr:/^([0-9-]{2}):([0-9-]{2})\s(AM|PM|--)$/,lenientString12hr:/^([0-9-]{1,2}):([0-9-]{1,2})\s(AM|PM|--|-)$/,string24hr:/^$|^([0-9]{2}):([0-9]{2})$/,lenientString24hr:/^$|^([0-9]{1,2}):([0-9]{1,2})$/,alphaNumericKeyName:/^[A-z0-9]$/},o={hrs12:{start:0,end:2,segment:"hrs12"},minutes:{start:3,end:5,segment:"minutes"},mode:{start:6,end:8,segment:"mode"}},l=[o.hrs12,o.minutes,o.mode],u={hrs24:{min:0,max:23},hrs12:{min:1,max:12},minutes:{min:0,max:59}},m=["hrs24","hrs12","minutes","mode"],a="time-input-polyfill-accessibility-block",d=e=>Array.prototype.slice.call(e,0),c=e=>{const t=Number(e);return isNaN(t)?null:t},h=e=>{if(null===e||"-"===e)return"--";const t=Number(e);return isNaN(t)&&"number"!=typeof e?e:t<10?`0${t}`:`${t}`};let g=!1;e.exists(e.window)&&e.window.addEventListener&&(e.window.addEventListener("keyup",(e=>g=e.shiftKey)),e.window.addEventListener("keydown",(e=>g=e.shiftKey)));const f=({value:e,format:t,minHrs:n,maxHrs:r})=>{if(!i[t].test(e))return!1;const s=i[t].exec(e)||[],o=c(s[1]),l=c(s[2]);return(null===o||o>=n&&o<=r)&&(null===l||l>=0&&l<=59)},b=e=>null!==e&&12<=e&&e<24,p=e=>{var t;return"PM"===(null===(t=i.string12hr.exec(e))||void 0===t?void 0:t[3])},w=e=>{var t;if(""===e)return!1;const n=c((null===(t=i.string24hr.exec(e))||void 0===t?void 0:t[1])||"");return"number"==typeof n&&n>11},v=e=>e.mode||null===e.hrs24?"PM"===e.mode:e.hrs24>11,M=e=>null!==e&&!b(e),O=e=>""!==e&&!w(e),j=e=>!v(e)&&S(e),y=e=>{if(void 0===e||"object"!=typeof e)return!1;const t=Object.keys(e);if(0===t.length)return!1;const n=m.filter((e=>-1===t.indexOf(e))),r=t.filter((e=>-1===m.indexOf(e)));return 0===n.length&&0===r.length},S=e=>{return!!y(e)&&(t=e,Object.keys(t)).every((t=>null!==e[t]));var t},$=e=>f({value:e,format:"string12hr",minHrs:1,maxHrs:12}),A=e=>""===e||f({value:e,format:"string24hr",minHrs:0,maxHrs:23}),x=e=>"string"==typeof e?`"${e}"`:null===e?"null":void 0===e?"undefined":e,H=e=>{if(!$(e))throw new Error(`"${e}" is not a valid 12 hour time, use the format "HH:MM AM/PM"`);return!0},T=e=>{if(!A(e)){const t=(/-/.test(e)?' Use an empty string instead of "--:--" to represent a blank value':/24:\d\d/.test(e)&&' Use "00" instead of "24".')||"";throw new Error(`"${e}" is not a valid 24 hour time.${t}`)}return!0},P=e=>{const{hrs24:t,hrs12:n,minutes:r,mode:s}=e;if(!y(e))throw new Error(`${JSON.stringify(e)} is not a valid time object. Must be in the format {hrs24: 0, hrs12: 12, minutes: 0, mode: 'AM'} (12:00 AM)`);const i=(e,t,n,r)=>{if("string"==typeof e&&"--"!==e||"number"==typeof e&&(e>r||e<n)){const s=x(e);throw new Error(`${t} (${s}) is invalid, "${t}" must be a number ${n}-${r} or null`)}};i(t,"hrs24",0,23),i(n,"hrs12",1,12),i(r,"minutes",0,59);const o=["AM","PM",null];if(o.indexOf(s)<0)throw new Error(`Mode (${x(s)}) is invalid. Valid values are: ${o.map((e=>x(e))).join(", ")}`);if(null!==t&&null===n)throw new Error(`hrs12 (${n}) must not be null if hrs24 (${t}) has a value`);if(0===t&&12!==n||null!==t&&n!==t&&t<13&&0!==t||"number"==typeof t&&t>12&&n!==t-12)throw new Error(`hrs12 (${n}) should be equal to or 12 hours behind hrs24 (${t})`);if(null!==s&&(t&&t>=12&&"PM"!==s||t&&t<=11&&"AM"!==s))throw"PM"===s?new Error(`If mode (${s}) is "PM", hrs24 (${t}) should be greater than or equal to 12`):new Error(`If mode (${s}) is "AM", hrs24 (${t}) should be less than or equal to 11`);if(null===s&&null!==t)throw new Error(`If mode is null, hrs24 (${t}) must be null as well. It is not possible to know the correct hrs24 value if mode is null`);if(null!==s&&null!==n&&null===t)throw new Error(`If mode (${s}) and hrs12 (${n}) are defined then hrs24 (${t}) must be defined as well`);return!0},E=e=>{if("number"!=typeof e&&"--"!==e||"number"==typeof e&&(e<0||e>23))throw new Error(`"${e}" must be a number between 0 and 23 or null, use 0 instead of 24`);return!0},L=e=>(H(e),{to24hr(){if(/-/.test(e))return"";const t=L(e).toTimeObject();return k(t).to24hr()},toTimeObject(){const t=i.string12hr.exec(e)||[],[n,r,s]=[c(t[1]),c(t[2]),"--"===t[3]?null:t[3]],o=e=>"--"===e?null:e,l=o(s),u={hrs24:l&&"number"==typeof n?null===s&&12===n?0:"PM"===s?12===n?12:n+12>23?n+12-24:n+12:"AM"===s&&12===n?0:n:null,hrs12:o(n),minutes:o(r),mode:l};return P(u),u}}),N=e=>(T(e),{to12hr(){if(e===n)return t;const r=N(e).toTimeObject();return k(r).to12hr()},toTimeObject(){if(e===n)return r;const t=i.string24hr.exec(e)||[],[s,o]=[t[1],t[2]],[l,u]=[c(s),c(o)],m={hrs24:l,hrs12:C(l).toHours12(),minutes:u,mode:(O(e)?"AM":w(e)&&"PM")||null};return P(m),m}}),k=(e,t=!1)=>{t||P(e);const{hrs24:n,hrs12:r,minutes:s,mode:i}=e,o=h(n),l=h(r),u=h(s);return{to12hr:()=>`${l}:${u} ${i||"--"}`,to24hr:()=>{const e=`${o}:${u}`;return/-/.test(e)?"":e}}},C=e=>{E(e);return{toHours12:()=>"number"==typeof e?e<=12?0===e?12:e:e-12:e}},I=e=>({to12hr(){const t=I(e).toTimeObject();return k(t).to12hr()},to24hr(){const t=I(e).toTimeObject();return k(t).to24hr()},toTimeObject(){const[t,n]=[e.getHours(),e.getMinutes()];return{hrs24:t,hrs12:C(t).toHours12(),minutes:n,mode:M(t)?"AM":"PM"}}}),V=(e,t)=>{const n=R(e).cursorSegment(),r=n.segment,s="forward"===t?1:-1,i=l.map((e=>e.segment)).indexOf(r)+s;return l[i]||n},U=e=>{const t=(null==e?void 0:e.value)||"",n=i.string12hr.test(t),r=i.string24hr.test(t);return{as12hrString:()=>n?t:N(t).to12hr(),as24hrString:()=>r?t:L(t).to24hr(),asTimeObject:()=>n?L(t).toTimeObject():N(t).toTimeObject()}},q=(t,n=e.window.document)=>{if(!t)return"";const r=function(t,n=e.window.document){const r=null==t?void 0:t.getAttribute("aria-labelledby");if(r){const e=n.getElementById(r);return _(e)}return""}(t,n)||function(e){const t=e.getAttribute("aria-label");return t||""}(t)||function(t,n=e.window.document){const r=n.querySelector('label[for="'+t.id+'"]');return _(r)}(t,n)||function(e){const t=K(e,"label"),n=t[t.length-1];return"LABEL"==n.nodeName?_(n):""}(t)||function(e){const t=e.getAttribute("title");return t||""}(t);if(r)return r;throw console.error("Label text for input not found.",t),new Error("Cannot polyfill time input due to a missing label.")},B=e=>R(e).cursorSegment().segment,R=e=>({rawSelection:()=>{if(!e)return{start:0,end:0,segment:"hrs12"};const t=(e,t)=>o[e].start<=t&&t<=o[e].end,n=e.selectionStart;return{start:n,end:e.selectionEnd,segment:(t("mode",n)?"mode":t("minutes",n)&&"minutes")||"hrs12"}},cursorSegment(){const{segment:t}=R(e).rawSelection();return o[t]},nextSegment:()=>V(e,"forward"),prevSegment:()=>V(e,"backward")}),K=(e,t)=>{let n=e;const r=[];let s=0;for(;n;){if(0!==s&&r.push(n),t){if(n.msMatchesSelector?n.msMatchesSelector(t):n.matches(t))return r}n=null==n?void 0:n.parentElement,s++}return r},_=e=>{var t;return(null===(t=null==e?void 0:e.textContent)||void 0===t?void 0:t.trim())||""};const D=(t=e.window.document)=>{const n=t.getElementById(a);n&&(n.innerHTML="")},J=e=>parseInt(e.join(""));class z{constructor({startingValue:e,segment:t,onUpdate:n,onLimitHit:r}){this.entries=[],this.value=e,this.segment=t,this.update=()=>n(),this.limitHit=()=>r()}add(e){const t=parseInt(e),n=0===t,r=!isNaN(t);if("mode"===this.segment)"a"===e.toLowerCase()&&(this.value="AM",this.entries=[e]),"p"===e.toLowerCase()&&(this.value="PM",this.entries=[e]);else if(r){const e=e=>"mode"!==this.segment&&e>u[this.segment].max,r=0===this.entries.length,s=1===this.entries.length,i=2===this.entries.length,o=n&&s&&0===this.entries[0];if("hrs12"===this.segment){if((r||i)&&n)return this.entries=[0],this.value=12,void this.update();if(o)return this.entries=[0,0],this.value=12,this.limitHit(),void this.update()}else if("minutes"===this.segment){if((r||i)&&n)return this.entries=[0],this.value=0,void this.update();if(o)return this.entries=[0,0],this.value=0,this.limitHit(),void this.update()}if(n&&s){const e="hrs12"===this.segment,n=e?1:5;return this.entries[0]>n?(this.entries=[0],this.value=e?12:0):(this.entries.push(t),this.value=J(this.entries),this.limitHit()),void this.update()}const l=[...this.entries,t],m=J(l);e(m)?(this.value=t,this.entries=[t],e(10*t)&&this.limitHit()):(this.value=m,this.entries=l,(2===l.length||e(10*t))&&this.limitHit())}this.update()}reset(){this.entries=[]}clear(){this.reset(),this.value=null,this.update()}}const Z=e=>{const t=t=>({isolated:()=>Z(e).toggleMode(t,!1),integrated:()=>Z(e).toggleMode(t,!0)}),n=t=>n=>{const r=B(n);return Z(e)[t][r]},r=(t,n)=>{const r=t(L(e).toTimeObject());return k(r,n).to12hr()};return{increment:{hrs12:{isolated:()=>r((e=>G(e).increment.hrs12.isolated())),integrated:()=>r((e=>G(e).increment.hrs12.integrated()))},minutes:{isolated:()=>r((e=>G(e).increment.minutes.isolated())),integrated:()=>r((e=>G(e).increment.minutes.integrated()))},mode:t("AM"),cursorSegment:n("increment")},decrement:{hrs12:{isolated:()=>r((e=>G(e).decrement.hrs12.isolated())),integrated:()=>r((e=>G(e).decrement.hrs12.integrated()))},minutes:{isolated:()=>r((e=>G(e).decrement.minutes.isolated())),integrated:()=>r((e=>G(e).decrement.minutes.integrated()))},mode:t("PM"),cursorSegment:n("decrement")},toggleMode:(e,t)=>r((n=>G(n).toggleMode(e,t)),!0),clear:{hrs12:()=>r((e=>G(e).clear.hrs12())),minutes:()=>r((e=>G(e).clear.minutes())),mode:()=>r((e=>G(e).clear.mode())),all:()=>r((e=>G(e).clear.all()))}}},F=e=>{const t=t=>({isolated:()=>F(e).toggleMode(t,!1),integrated:()=>F(e).toggleMode(t,!0)}),n=(t,n)=>{const r=t(N(e).toTimeObject());return k(r,n).to24hr()};return{increment:{hrs24:{isolated:()=>n((e=>G(e).increment.hrs24.isolated())),integrated:()=>n((e=>G(e).increment.hrs24.integrated()))},minutes:{isolated:()=>n((e=>G(e).increment.minutes.isolated())),integrated:()=>n((e=>G(e).increment.minutes.integrated()))},mode:t("AM")},decrement:{hrs24:{isolated:()=>n((e=>G(e).decrement.hrs24.isolated())),integrated:()=>n((e=>G(e).decrement.hrs24.integrated()))},minutes:{isolated:()=>n((e=>G(e).decrement.minutes.isolated())),integrated:()=>n((e=>G(e).decrement.minutes.integrated()))},mode:t("PM")},toggleMode:(e,t)=>n((n=>G(n).toggleMode(e,t)),!0)}},G=e=>{const t=t=>({isolated:()=>G(e).toggleMode(t,!1),integrated:()=>G(e).toggleMode(t,!0)}),n=t=>n=>{const r=B(n);return G(e)[t][r]};return{increment:{hrs12:{isolated:()=>W("up",e),integrated:()=>X("up",e)},hrs24:{isolated:()=>G(e).increment.hrs12.isolated(),integrated:()=>G(e).increment.hrs12.integrated()},minutes:{isolated:()=>{const{minutes:t}=e,n=t===u.minutes.max?u.minutes.min:Q(t,"up");return Object.assign(Object.assign({},e),{minutes:n})},integrated:()=>{const{minutes:t}=e;return t===u.minutes.max?X("up",Object.assign(Object.assign({},e),{minutes:u.minutes.min})):Object.assign(Object.assign({},e),{minutes:Q(t,"up")})}},mode:t("AM"),cursorSegment:n("increment")},decrement:{hrs12:{isolated:()=>W("down",e),integrated:()=>X("down",e)},hrs24:{isolated:()=>G(e).decrement.hrs12.isolated(),integrated:()=>G(e).decrement.hrs12.integrated()},minutes:{isolated:()=>{const{minutes:t}=e,n=t===u.minutes.min?u.minutes.max:Q(t,"down");return Object.assign(Object.assign({},e),{minutes:n})},integrated:()=>{const{minutes:t}=e;return t===u.minutes.min?X("down",Object.assign(Object.assign({},e),{minutes:u.minutes.max})):Object.assign(Object.assign({},e),{minutes:Q(t,"down")})}},mode:t("PM"),cursorSegment:n("decrement")},toggleMode:(t,n)=>{const{hrs12:r,hrs24:s,mode:i}=e,o=Object.assign({},e),l=j(e),u=e=>{let t;if(null===r)t=null;else{const n=12===r,s={am:n?0:r,pm:n?12:r+12};t="AM"===e?s.am:s.pm}return t};return null===i?n&&null!==s?(o.mode=s>11?"PM":"AM",o.hrs24=s):(o.mode=t,o.hrs24=u(t)):(o.mode=l?"PM":"AM",o.hrs24=u(l?"PM":"AM")),null===r&&null===i?o:ee("hrs24",o)},clear:{hrs24:()=>Object.assign(Object.assign({},e),{hrs12:null,hrs24:null}),hrs12:()=>Object.assign(Object.assign({},e),{hrs12:null,hrs24:null}),minutes:()=>Object.assign(Object.assign({},e),{minutes:null}),mode:()=>Object.assign(Object.assign({},e),{mode:null,hrs24:null}),all:()=>r}}},Q=(e,t)=>null===e?"up"===t?0:59:e+("up"===t?1:-1),W=(e,t)=>Y({direction:e,timeObject:t,integration:"isolated",blankCallback:t=>("up"===e?"PM"===t.mode?(t.hrs24=13,t.hrs12=1):"AM"===t.mode?(t.hrs24=1,t.hrs12=1):t.hrs12=1:"PM"===t.mode?(t.hrs24=12,t.hrs12=12):"AM"===t.mode?(t.hrs24=0,t.hrs12=12):t.hrs12=12,t)}),X=(e,t)=>Y({direction:e,timeObject:t,integration:"integrated",blankCallback:t=>W(e,t)}),Y=({direction:e,timeObject:t,integration:n,blankCallback:r})=>{const s="integrated"===n?"hrs24":"hrs12",i=t[s],o=Object.assign({},t),l="up"===e,m=l?u[s].max:u[s].min,a=l?u[s].min:u[s].max,d=l?1:-1;return"number"==typeof i?(o[s]=i===m?a:i+d,ee(s,o)):r(ee(s,o))},ee=(e,t)=>{const{hrs24:n,hrs12:r,minutes:s}=t,i=te(e,t),o="AM"===i,l="hrs12"===e;return{hrs12:l?r:(()=>{const e=null!==n&&n>12?n-12:n;return 0===e?12:e})(),hrs24:l?(()=>{const e=null===i?null:o||null===r||12===r?r:r+12;return null===e?null:24===e?0:e>=12&&o?e-12:e})():n,minutes:s,mode:i}},te=(e,t)=>{const{hrs24:n,mode:r}=t;return null===r?null:"hrs12"===e?null===r?"AM":r:"hrs24"===e&&null===t.hrs24&&null!==r?r:n&&n>11?"PM":"AM"};var ne=Object.freeze({__proto__:null,a11yCreate:(t=e.window.document)=>{var n;const r=t.createElement("div");return r.setAttribute("aria-live","polite"),r.setAttribute("style","position: absolute; opacity: 0; height: 0; width: 0; overflow: hidden; pointer-events: none;"),r.id=a,null===(n=t.querySelector("body"))||void 0===n||n.appendChild(r),r},a11yUpdate:(t,n,r=e.window.document)=>{if(!t)return"";D(r);const s=B(t),i=U(t).asTimeObject()[s],o=null===i?"blank":i,l={hrs12:"Hours",minutes:"Minutes",mode:"AM/PM"}[s],u={initial:"$label grouping $fullValue.",select:"$segmentName spin button $segmentValue.",update:"$segmentValue."},m=n.map((e=>u[e])),d=t.value.replace(/--/g,"blank");let c=`<p>${m.join("</p><p>")}</p>`;const h=q(t,r);c=c.replace(/\$label/g,h),c=c.replace(/\$segmentName/g,l),c=c.replace(/\$segmentValue/g,`${o}`),c=c.replace(/\$fullValue/g,d);const g=r.getElementById(a);return g&&(g.innerHTML=c),c},a11yClear:D,getA11yValue:(t=e.window.document)=>{const n=t.getElementById(a);return(null==n?void 0:n.textContent)?n.textContent:""},getA11yElement:(t=e.window.document)=>t.getElementById(a),convertString12hr:L,convertString24hr:N,convertTimeObject:k,convertHours24:C,convertDateObject:I,flash24hrTime:e=>{const t=e.value;e.value=L(t).to24hr(),setTimeout((()=>{e.value=t}),1)},getString12hr:e=>{const t=L(e).toTimeObject();return Object.assign(Object.assign({},t),{timeObject:t})},getString24hr:e=>{const t=N(e).toTimeObject();return Object.assign(Object.assign({},t),{timeObject:t})},getInputValue:U,getLabelTextOf:q,getCursorSegment:B,getPrevSegment:e=>{if("string"==typeof e){if("hrs12"===e)return"hrs12";if("minutes"===e)return"hrs12";if("mode"===e)return"minutes"}return R(e).prevSegment().segment},getNextSegment:e=>{if("string"==typeof e){if("hrs12"===e)return"minutes";if("minutes"===e)return"mode";if("mode"===e)return"mode"}return R(e).nextSegment().segment},getRangeOf:R,getAncestorsOf:K,get isShiftHeldDown(){return g},isPmHrs24:b,isPmString12hr:p,isPmString24hr:w,isPmTimeObject:v,isAmHrs24:M,isAmString12hr:e=>i.string12hr.test(e)&&-1===e.indexOf("--")&&!p(e),isAmString24hr:O,isAmTimeObject:j,isTimeObject:y,isCompleteTimeObject:S,isString12hr:$,isString24hr:A,ManualEntryLog:class{constructor({timeObject:e,onUpdate:t=(()=>{}),onLimitHit:n=(()=>{})}){const r=()=>[h(this.hrs12.value),":",h(this.minutes.value)," ",this.mode.value||"--"].join(""),s=()=>{this.fullValue12hr=r(),t&&t(this)},i=()=>{n&&n(this)};this.hrs12=new z({startingValue:e.hrs12,segment:"hrs12",onUpdate:s,onLimitHit:i}),this.minutes=new z({startingValue:e.minutes,segment:"minutes",onUpdate:s,onLimitHit:i}),this.mode=new z({startingValue:e.mode,segment:"mode",onUpdate:s,onLimitHit:i}),this.fullValue12hr=r()}clearAll(){this.hrs12.clear(),this.minutes.clear(),this.mode.clear()}},modifyString12hr:Z,modifyString24hr:F,modifyTimeObject:G,regex:i,selectAll:(t,n=e.document)=>{const r=n.querySelectorAll(t);return d(r)},selectSegment:(e,t="hrs12")=>{e&&e.setSelectionRange(o[t].start,o[t].end)},selectNextSegment:e=>{if(!e)return;const{start:t,end:n}=R(e).nextSegment();e.setSelectionRange(t,n)},selectPrevSegment:e=>{if(!e)return;const{start:t,end:n}=R(e).prevSegment();e.setSelectionRange(t,n)},selectCursorSegment:e=>{if(!e)return;const{start:t,end:n}=R(e).cursorSegment();e.setSelectionRange(t,n)},ranges:o,rangesList:l,maxAndMins:u,segments:["hrs12","minutes","mode"],timeObjectKeys:m,a11yID:a,toArray:d,toNumber:c,toLeadingZero:h,toLeadingZero12HrString:e=>{if(!e)return"--:-- --";const[t,n,r,s]=i.lenientString12hr.exec(e)||[];return`${h(n)}:${h(r)} ${h(s)}`},matchesTimeObject:(e,t)=>JSON.stringify(e)===JSON.stringify(t),validateString12hr:H,validateString24hr:T,validateTimeObject:P,validateHours24:E});e.exists(e.window)&&(e.window.timeInputPolyfillUtils=ne)}));
